labs(title = 'Males (GAM)', x = 'Day of Year')+
l_fitLine(linetype = 1, size = 2)  +
l_fitContour()+
#l_ciLine(mul = 5, colour = "blue", linetype = 2) +
l_ciPoly(level = 0.95, alpha = 1/2)+
l_ciBar() +
theme(axis.text=element_text(size=18),
axis.title=element_text(size=20,face="bold"))
theme_get()
fig6 =paste("G:/My Drive/GofAK_TPWS_metadataReduced/SeasonalityAnalysis/",site,'/',site,"GAM1_Males.png",sep="")
ggsave(fig6)
#second way to plot GAM
vizGG2 = plot(viz, allTerms = T) +
l_fitLine(colour = "red") + l_rug(mapping = aes(x=x,y=y), alpha=0.8) +
labs(title = 'Males (GAM)')+
l_ciLine(mul = 5, colour = "blue", linetype = 2)+
l_points(shape = 19, size = 1, alpha = 0.1) + theme_classic()
print(vizGG2,pages =1)
fig7 =paste("G:/My Drive/GofAK_TPWS_metadataReduced/SeasonalityAnalysis/",site,'/',site,"GAM2_Males.png",sep="")
ggsave(fig7)
SpeciesOccurence <- occurrence(geometry = "POLYGON ((34.0,-119.4, 34.1  -119.4, 34.1 -119.4, 34 -119.4, 34.0 -119.4)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((34.0,-119.4, 34.1  -119.4, 34.1 -119.4, 34 -119.4, 34.0 -119.4)) ")
knitr::opts_chunk$set(echo = TRUE)
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-70.2 43.5, -69.8 43.5, -69.8 43.9, -70.2 43.9, -70.2 43.5)) ")
#loading robis
installed <- rownames(installed.packages())
if ( !("robis" %in% installed) ){
if ( !("remotes" %in% installed) )install.packages("remotes")
remotes::install_github("iobis/robis")
}
#load libraries
library(robis)
library('ggplot2')
library("rnaturalearth")
library("rnaturalearthdata")
library(roperators)
library(dplyr)
library(dggridR)
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-70.2 43.5, -69.8 43.5, -69.8 43.9, -70.2 43.9, -70.2 43.5)) ")
#loading robis
installed <- rownames(installed.packages())
if ( !("robis" %in% installed) ){
if ( !("remotes" %in% installed) )install.packages("remotes")
remotes::install_github("iobis/robis")
}
#load libraries
library(robis)
library('ggplot2')
library("rnaturalearth")
library("rnaturalearthdata")
library(roperators)
library(dplyr)
library(dggridR)
#loading robis
installed <- rownames(installed.packages())
if ( !("robis" %in% installed) ){
if ( !("remotes" %in% installed) )install.packages("remotes")
remotes::install_github("iobis/robis")
}
#load libraries
library(robis)
library('ggplot2')
library("rnaturalearth")
library("rnaturalearthdata")
library(roperators)
library(dplyr)
library(magrittr)
library(vegan)
library(dggridR)
SpeciesOccurence <- occurrence(geometry = "POLYGON ((34.0,-119.4, 34.1  -119.4, 34.1 -119.4, 34 -119.4, 34.0 -119.4)) ")
#loading robis
installed <- rownames(installed.packages())
if ( !("robis" %in% installed) ){
if ( !("remotes" %in% installed) )install.packages("remotes")
remotes::install_github("iobis/robis")
}
#load libraries
library(robis)
library('ggplot2')
library("rnaturalearth")
library("rnaturalearthdata")
library(roperators)
library(dplyr)
library(dggridR)
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-70.2 43.5, -69.8 43.5, -69.8 43.9, -70.2 43.9, -70.2 43.5)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((34.0,-119.4, 34.1  -119.4, 34.1 -119.4, 34 -119.4, 34.0 -119.4)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((34.0 -119.4, 34.1  -119.4, 34.1 -119.4, 34 -119.4, 34.0 -119.4)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((34.0 -119.4, 34.1  -119.4, 34.1 -119.4, 34 -119.4, 34.0 -119.4)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((34.0 -119.4, 34.1 -119.4, 34.1 -119.4, 34 -119.4, 34.0 -119.4)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-119.4 34.0, -119.4 34.1, -119.4 34.1, -119.4 34,
-119.4 34.0)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-119.4 34.0, -119.4 34.1, -119.4 34.1, -119.4 34, -119.4 34.0)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((34.0 -119.4, 34.1 -119.4, 34.1 -119.4, 34 -119.4, 34.0 -119.4)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((34.0 -119.4, 34.1 -119.4, 34.1 -119.4, 34 -119.4, 34.0 -119.4)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-119.4 34.0, -119.4 34.1, -119.4 34.1, -119.4 34.0, -119.4 34.0)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-119.4 34.0, -119.4 34.1, -119.4 34.1, -119.4 34.0, -119.4 34.0))")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-119.41 34.0, -119.41 34.08, -119.36 34.08, -119.36 34.0, -119.36 34.01))")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-120.58357239 34.20654297, -118.90743256 33.36573029))")
occurence("Pterois volitans")
ptevol <- occurrence("Pterois volitans")
View(ptevol)
SpeciesOccurence <- occurrence(geometry = "POLYGON ((34.0 -119.41, 34.08 -119.41, 34.08 -119.36, 34.0 -119.36, 34.01 -119.36)) ")
(geometry = "POLYGON ((-119.41 34.0, -119.41 34.08, -119.36 34.08, -119.36 34.0, -119.36 34.01))")
geometry = "POLYGON ((-119.41 34.0, -119.41 34.08, -119.36 34.08, -119.36 34.0, -119.36 34.01))
""
""
geometry = "POLYGON ((-119.41 34.0, -119.41 34.08, -119.36 34.08, -119.36 34.0, -119.36 34.01))"
view(geometry)
View(geometry)
#loading robis
installed <- rownames(installed.packages())
if ( !("robis" %in% installed) ){
if ( !("remotes" %in% installed) )install.packages("remotes")
remotes::install_github("iobis/robis")
}
#load libraries
library(robis)
library('ggplot2')
library("rnaturalearth")
library("rnaturalearthdata")
library(roperators)
library(dplyr)
library(magrittr)
library(vegan)
SpeciesOccurence <- occurrence(geometry = "POLYGON ((34.0 -119.41, 34.08 -119.41, 34.08 -119.36, 34.0 -119.36, 34.01 -119.36)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-119.41 34.0, -119.41 34.08, -119.36 34.08, -119.36 34.0, -119.36 34.01))")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-120.58357239 34.20654297, -118.90743256 33.36573029))")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-70.2 43.5, -69.8 43.5, -69.8 43.9, -70.2 43.9, -70.2 43.5)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-119.41 34.0, -119.41 34.08, -119.36 34.08, -119.36 34.0, -119.36 34.01)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-120.58357239 34.20654297, -118.90743256 33.36573029)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-119.41 34.0, -119.41 34.08, -119.36 34.08, -119.36 34.0)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-119.41 34.006, -119.41 34.08, -119.36 34.08, -119.36 34.006, -119.36 34.01)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-119.41 34.0, -119.41 34.08, -119.36 34.08, -119.36 34.006, -119.41 34.0)) ")
View(SpeciesOccurence)
View(SpeciesOccurece)
View(SpeciesOccurence)
leafletmap(SpeciesOccurence)
install.packages("leaflet")
library(leafletmap)
library(leaflet)
leafletmap(SpeciesOccurence)
leafletmap(SpeciesOccurence)
library(leaflet)
leafletmap(SpeciesOccurence)
leaflet(SpeciesOccurence)
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-117.32 32.83, -117.34 32.83, -117.33 32.80, -117.32 32.80, -117.32 32.83)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-117.32 32.83, -117.34 32.83, -117.33 32.80, -117.32 32.80, -117.32 32.83, -117.32 32.83)) ")
#loading robis
installed <- rownames(installed.packages())
if ( !("robis" %in% installed) ){
if ( !("remotes" %in% installed) )install.packages("remotes")
remotes::install_github("iobis/robis")
}
#load libraries
library(robis)
library('ggplot2')
library("rnaturalearth")
library("rnaturalearthdata")
library(roperators)
library(dplyr)
library(magrittr)
library(vegan)
library(leaflet)
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-117.32 32.83, -117.34 32.83, -117.33 32.80, -117.32 32.80, -117.32 32.83, -117.32 32.83)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-117.32 32.83, -117.34 32.83, -117.33 32.80, -117.32 32.80, -117.32 32.83)) ")
#loading robis
installed <- rownames(installed.packages())
if ( !("robis" %in% installed) ){
if ( !("remotes" %in% installed) )install.packages("remotes")
remotes::install_github("iobis/robis")
}
#load libraries
library(robis)
library('ggplot2')
library("rnaturalearth")
library("rnaturalearthdata")
library(roperators)
library(dplyr)
library(magrittr)
library(vegan)
library(leaflet)
x = data.frame(lat = c("32°49.573", "32°47.945",  "32°47.945", "32°49.573", "32°49.573"),
lon = c("-117°19.000", "-117°20.528", "-117°20.068", "-117°19.000", "-117°19.000"))
x$lat = gsub('°', ' ', x$lat)
x$lon = gsub('°', ' ', x$lon)
#convert from decimalminute to decimal degree
x$latdec = measurements::conv_unit(x$lat, from = 'deg_dec_min', to = 'dec_deg')
install.packages("measurements")
library(measurements)
x = data.frame(lat = c("32°49.573", "32°47.945",  "32°47.945", "32°49.573", "32°49.573"),
lon = c("-117°19.000", "-117°20.528", "-117°20.068", "-117°19.000", "-117°19.000"))
x$lat = gsub('°', ' ', x$lat)
x$lon = gsub('°', ' ', x$lon)
#convert from decimalminute to decimal degree
x$latdec = measurements::conv_unit(x$lat, from = 'deg_dec_min', to = 'dec_deg')
x$londec = measurements::conv_unit(x$lon, from = 'deg_dec_min', to = 'dec_deg')
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-119.41 34.0, -119.41 34.08, -119.36 34.08, -119.36 34.006, -119.41 34.0)) ")
# <- occurrence(geometry = "POLYGON ((-117.32 32.83, -117.34 32.83, -117.33 32.80, -117.32 32.80, -117.32 32.83)) ")
library(ncdf4)
library(httr)
library (naniar)
library(ggmap)
library(OpenStreetMap)
install.packages("OpenStreetMap")
PATH="${RTOOLS40_HOME}\usr\bin;${PATH}"
writeLines('PATH="${RTOOLS40_HOME}\\usr\\bin;${PATH}"', con = "~/.Renviron")
install.packages("OpenStreetMap")
Sys.which("make")
install.packages("OpenStreetMap")
install.packages("blackbox")
library(ncdf4)
library(httr)
library (naniar)
library(ggmap)
library(OpenStreetMap)
setwd("~/GitHub/CanadianArctic")
install.packages(c("anytime", "car", "cplm", "epitools", "fANCOVA", "gee", "geepack", "ggpubr", "locfit", "mgcViz", "MuMIn", "statmod", "TSA", "tweedie"))
filename = paste('E:\Project_Sites\CANARC\Plots\DailyIceTable.xlsx',sep="")
filename = paste('E:/Project_Sites/CANARC/Plots/DailyIceTable.xlsx',sep="")
DayIce = read.csv(filename)
filename = paste('DailyIceTable.csv',sep="")
DayIce = read.csv(filename)
View(DayIce)
head(DayIce)
str(DayIce)
DayIce$tbin = anytime(as.factor(DayIce$tbin))
library(ggplot2)
library(dplyr)
library(forcats)
library(ggpubr)
library(plyr)
library(anytime)
library(fANCOVA)
library(tweedie)
library(car)
library(locfit)
library(MuMIn)
library(tidyverse)
library(mgcv)
library(ggpubr)
library(mgcViz)
library(cplm)
library(statmod)
library(gee)
library(geepack)
library(TSA)
library(epitools)
library(lubridate)
library(survival)
DayIce$tbin = anytime(as.factor(DayIce$tbin))
title2 = paste("Average Daily Presence Per Year",site)
ggplot(dayBinTAB, aes(x=Year, y=DutyBin))+
geom_boxplot()+
ggtitle(title2)+
labs(y="Proportion of Hours per Day with Clicks")
scale_color_brewer(palette = "Dark2")
title2 = paste("Average Daily Presence Per Year",site)
ggplot(DayIce, aes(x=Year, y=DutyBin))+
geom_boxplot()+
ggtitle(title2)+
labs(y="Proportion of Hours per Day with Clicks")
scale_color_brewer(palette = "Dark2")
#plot data as box plot for years
title2 = paste("Average Daily Presence Per Year")
ggplot(DayIce, aes(x=Year, y=DutyBin))+
geom_boxplot()+
ggtitle(title2)+
labs(y="Proportion of Hours per Day with Clicks")
scale_color_brewer(palette = "Dark2")
DayIce$YearF = as.factor(DayIce$Year) #change season from an integer to a factor
DayIce$YearF = as.factor(DayIce$Year) #change season from an integer to a factor
title2 = paste("Average Daily Presence Per Year")
ggplot(DayIce, aes(x=YearF, y=DutyBin))+
geom_boxplot()+
ggtitle(title2)+
labs(y="Proportion of Hours per Day with Clicks")
scale_color_brewer(palette = "Dark2")
DayIce$YearF = as.factor(DayIce$Year) #change season from an integer to a factor
title2 = paste("Average Daily Presence Per Year")
ggplot(DayIce, aes(x=YearF, y=DutyBin))+
geom_boxplot()+
ggtitle(title2)+
labs(y="Average # of 5 min bins per day")
scale_color_brewer(palette = "Dark2")
DayIce$YearF = as.factor(DayIce$Year) #change season from an integer to a factor
title2 = paste("Average Daily Presence Per Year")
ggplot(DayIce, aes(x=YearF, y=DutyBin))+
geom_boxplot()+
ggtitle(title2)+
labs(y="Average # of 5 min bins per day")
View(DayIce)
gamTw = gam(DutyBin ~ s(day, bs = 'cc', k = 15)+YearF+Ice, data = DayIce, family = tw, method = "REML")
plot(gamTw, pages =1)
summary(gamTw)
gamTw = gam(DutyBin ~ s(day, bs = 'cc', k = 15)+s(YearF)+s(Ice), data = DayIce, family = tw, method = "REML")
plot(gamTw, pages =1)
summary(gamTw)
gamTw = gam(DutyBin ~ s(day, bs = 'cc', k = 15)+YearF+Ice, data = DayIce, family = tw, method = "REML")
plot(gamTw)
gamTw = gam(DutyBin ~ s(day, bs = 'cc', k = 15)+YearF+s(Ice), data = DayIce, family = tw, method = "REML")
plot(gamTw)
gamTw = gam(DutyBin ~ s(day, bs = 'cc', k = 15)+YearF+s(Ice), data = DayIce, family = tw, method = "REML")
plot(gamTw, pages = 1)
summary(gamTw)
gamTw = gam(DutyBin ~ s(day, bs = 'cc', k = 15)+s(Year)+s(Ice), data = DayIce, family = tw, method = "REML")
plot(gamTw, pages = 1)
summary(gamTw)
gamTw = gam(DutyBin ~ s(day, bs = 'cc', k = 4)+s(Year)+s(Ice), data = DayIce, family = tw, method = "REML")
plot(gamTw, pages = 1)
summary(gamTw)
gamTw = gam(DutyBin ~ s(day, bs = 'cc', k = 3)+s(Year)+s(Ice), data = DayIce, family = tw, method = "REML")
plot(gamTw, pages = 1)
summary(gamTw)
gamTw = gam(DutyBin ~ s(day, bs = 'cc', k = 3)+Year+s(Ice), data = DayIce, family = tw, method = "REML")
plot(gamTw, pages = 1)
summary(gamTw)
gamTw = gam(DutyBin ~ s(day, bs = 'cc', k = 15)+Year+s(Ice), data = DayIce, family = tw, method = "REML")
plot(gamTw, pages = 1)
summary(gamTw)
gamTw = gam(DutyBin ~ s(day, bs = 'cc', k = 15)+s(Ice)+s(Year, k = 1), data = DayIce, family = tw, method = "REML")
plot(gamTw, pages = 1)
summary(gamTw)
gamTw = gam(DutyBin ~ s(day, bs = 'cc', k = 15)+s(Ice)+s(Year, k = 2), data = DayIce, family = tw, method = "REML")
plot(gamTw, pages = 1)
summary(gamTw)
gamTw = gam(DutyBin ~ s(day, bs = 'cc', k = 15)+s(Ice)+s(Year, k = 5), data = DayIce, family = tw, method = "REML")
plot(gamTw, pages = 1)
summary(gamTw)
viz = getViz(gamTw)
print(plot(viz,allTerms=T),pages=1)
DayIceHARP = DayIce[DayIce$Year == 2015]
DayIceHARP = DayIce[!DayIce$Year == 2015]
View(DayIce)
DayIceHARP = DayIce[!DayIce$Year == "2015"]
DayIceHARP = DayIce[!DayIce$YearF == "2015"]
DayIceHARP = DayIce[!DayIce$YearF == "2015",]
vizGG = plot(viz,allTerms = T) +
l_points() +
labs(title = 'Sperm whales (GAM)')+
l_fitLine(linetype = 3)  +
l_fitContour()+
l_ciLine(mul = 5, colour = "blue", linetype = 2) +
l_ciBar() +
l_points(shape = 19, size = 1, alpha = 0.1) +
l_rug() +
theme_get()
print(vizGG,pages =1)
vizGG = plot(viz,allTerms = T) +
labs(title = 'Sperm whales (GAM)')+
l_fitLine(linetype = 3)  +
l_fitContour()+
l_ciLine(mul = 5, colour = "blue", linetype = 2) +
l_ciBar() +
l_points(shape = 19, size = 1, alpha = 0.1) +
l_rug() +
theme_get()
print(vizGG,pages =1)
vizGG = plot(viz,allTerms = T) +
labs(title = 'Sperm whales (GAM)')+
l_fitLine(linetype = 3)  +
l_fitContour()+
l_ciLine(mul = 5, colour = "blue", linetype = 2) +
l_ciBar() +
l_rug() +
theme_get()
print(vizGG,pages =1)
fig6 =paste("G:/.shortcut-targets-by-id/1lwxYjZ-5ScY65o65OfWCtYU-FpMLIpXS/Arctic_Sperm whales/figures/GAM1.png",sep="")
ggsave(fig6)
vizGG2 = plot(viz, allTerms = T) +
l_fitLine(colour = "red") + l_rug(mapping = aes(x=x,y=y), alpha=0.8) +
labs(title = 'Sperm whales (GAM)')+
l_ciLine(mul = 5, colour = "blue", linetype = 2)+
l_points(shape = 19, size = 1, alpha = 0.1) + theme_classic()
print(vizGG2,pages =1)
vizGG2 = plot(viz, allTerms = T) +
l_fitLine(colour = "red") +
labs(title = 'Sperm whales (GAM)')+
l_ciLine(mul = 5, colour = "blue", linetype = 2)+
l_points(shape = 19, size = 1, alpha = 0.1) + theme_classic()
print(vizGG2,pages =1)
vizGG2 = plot(viz, allTerms = T) +
l_fitLine(colour = "red") +
labs(title = 'Sperm whales (GAM)')+
l_ciLine(mul = 5, colour = "blue", linetype = 2)+
theme_classic()
print(vizGG2,pages =1)
fig7 =paste("G:/.shortcut-targets-by-id/1lwxYjZ-5ScY65o65OfWCtYU-FpMLIpXS/Arctic_Sperm whales/figures/GAM2_Allyears.png",sep="")
ggsave(fig7)
gamTw = gam(DutyBin ~ s(day, bs = 'cc', k = 15)+s(Ice)+s(Year, k = 4), data = DayIceHARP, family = tw, method = "REML")
plot(gamTw, pages = 1)
summary(gamTw)
gamTw = gam(DutyBin ~ s(day, bs = 'cc', k = 15)+s(Ice)+s(YearF, k = 4), data = DayIceHARP, family = tw, method = "REML")
plot(gamTw, pages = 1)
summary(gamTw)
View(DayIceHARP)
View(DayIce)
DayIceHARP = subset(DayIce, Year!="2015")
gamTw = gam(DutyBin ~ s(day, bs = 'cc', k = 15)+s(Ice)+s(Year, k = 4), data = DayIceHARP, family = tw, method = "REML")
plot(gamTw, pages = 1)
summary(gamTw)
#pattern only
viz = getViz(gamTw)
print(plot(viz,allTerms=T),pages=1)
#first way to plot GAM
vizGG = plot(viz,allTerms = T) +
labs(title = 'Sperm whales (GAM)')+
l_fitLine(linetype = 3)  +
l_fitContour()+
l_ciLine(mul = 5, colour = "blue", linetype = 2) +
l_ciBar() +
l_rug() +
theme_get()
print(vizGG,pages =1)
fig6 =paste("G:/.shortcut-targets-by-id/1lwxYjZ-5ScY65o65OfWCtYU-FpMLIpXS/Arctic_Sperm whales/figures/GAM1_HARPyears.png",sep="")
ggsave(fig6)
#second way to plot GAM
vizGG2 = plot(viz, allTerms = T) +
l_fitLine(colour = "red") +
labs(title = 'Sperm whales (GAM)')+
l_ciLine(mul = 5, colour = "blue", linetype = 2)+
theme_classic()
print(vizGG2,pages =1)
fig7 =paste("G:/.shortcut-targets-by-id/1lwxYjZ-5ScY65o65OfWCtYU-FpMLIpXS/Arctic_Sperm whales/figures/GAM2_HARPyears.png",sep="")
ggsave(fig7)
gamTw = gam(DutyBin ~ s(day, bs = 'cc', k = 15)+s(Ice)+s(Year, k = 5), data = DayIce, family = tw, method = "REML")
plot(gamTw, pages = 1)
summary(gamTw)
gamTw = gam(DutyBin ~ s(day, bs = 'cc', k = 15)+s(Ice)+s(Year, k = 4), data = DayIceHARP, family = tw, method = "REML")
plot(gamTw, pages = 1)
summary(gamTw)
gamTw = gamm(DutyBin ~ s(day, bs = 'cc', k = 15)+s(Ice)+s(Year, k = 4), data = DayIceHARP, family = tw, method = "REML")
plot(gamTw, pages = 1)
gamTw = gamm(DutyBin ~ s(day, bs = 'cc', k = 15)+s(Ice)+s(Year, k = 4), data = DayIceHARP, family = tw, method = "REML", list(year=~1))
gamTw = gamm(DutyBin ~ s(day, bs = 'cc', k = 15)+s(Ice)+s(Year, k = 4), data = DayIceHARP, family = tw, method = "REML", list(Year=~1))
gam.ME = gamm(DutyBin ~ s(day, bs = 'cc', k = 15)+s(Ice)+s(Year, k = 4), data = DayIceHARP, family = tw, method = "REML", list(Year=~1))
gam.ME = gamm(DutyBin ~ s(day, bs = 'cc', k = 15)+s(Ice)+s(Year, k = 4), data = DayIceHARP, family = tw, method = "REML")
summary(gam.ME[[1]])
summary(gam.ME[[2]])
plot(gam.ME, pages = 1)
plot(gam.ME[[2]], pages = 1)
gam.ME = gamm(DutyBin ~ s(day, bs = 'cc', k = 15)+s(Ice)+s(Year, k = 4), data = DayIce, family = tw, method = "REML")
plot(gam.ME[[2]], pages = 1)
summary(gam.ME[[1]])
summary(gam.ME[[2]])
gam.ME = gamm(DutyBin ~ s(day, bs = 'cc', k = 15)+s(Ice)+s(Year, k = 4), data = DayIce, family = tw, method = "REML")
plot(gam.ME[[2]], pages = 1)
summary(gam.ME[[1]])
summary(gam.ME[[2]])
viz = getViz(gam.ME)
print(plot(viz,allTerms=T),pages=1)
gam.ME = gamm(DutyBin ~ s(day, bs = 'cc', k = 15)+s(Ice)+s(Year, k = 4), data = DayIce, family = tw, method = "REML")
plot(gam.ME[[2]], pages = 1)
summary(gam.ME[[1]])
summary(gam.ME[[2]])
viz = getViz(gam.ME[[1]])
print(plot(viz,allTerms=T),pages=1)
gam.ME = gammV(DutyBin ~ s(day, bs = 'cc', k = 15)+s(Ice)+s(Year, k = 4), data = DayIce, family = tw, method = "REML")
plot(gam.ME[[2]], pages = 1)
summary(gam.ME[[1]])
summary(gam.ME[[2]])
plot(gam.ME, pages = 1)
gam.ME = gamm(DutyBin ~ s(day, bs = 'cc', k = 15)+s(Ice)+s(Year, k = 4), data = DayIce, family = tw, method = "REML")
plot(gam.ME[[2]], pages = 1)
summary(gam.ME[[1]])
summary(gam.ME[[2]])
viz = getViz(gam.ME[[2]])
print(plot(viz,allTerms=T),pages=1)
fig7 =paste("G:/.shortcut-targets-by-id/1lwxYjZ-5ScY65o65OfWCtYU-FpMLIpXS/Arctic_Sperm whales/figures/GAMM_AllYears.png",sep="")
ggsave(fig7)
gam.ME = gamm(DutyBin ~ s(day, bs = 'cc', k = 15)+s(Ice)+s(Year, k = 4), data = DayIceHARP, family = tw, method = "REML")
plot(gam.ME[[2]], pages = 1)
summary(gam.ME[[1]])
summary(gam.ME[[2]])
viz = getViz(gam.ME[[2]])
print(plot(viz,allTerms=T),pages=1)
fig7 =paste("G:/.shortcut-targets-by-id/1lwxYjZ-5ScY65o65OfWCtYU-FpMLIpXS/Arctic_Sperm whales/figures/GAMM_HARPYears.png",sep="")
ggsave(fig7)
gam.ME = gamm(DutyBin ~ s(day, bs = 'cc', k = 15)+s(Ice)+s(Year, k = 4), data = DayIce, family = tw, method = "REML")
plot(gam.ME[[2]], pages = 1)
summary(gam.ME[[1]])
summary(gam.ME[[2]])
n = 4
Grouped = aggregate(DayIce,list(rep(1:(nrow(DayIce)%/%n+1),each=n,len=nrow(DayIce))),mean)[-1];
gamTw = gam(DutyBin ~ s(day, bs = 'cc', k = 15)+s(Ice)+s(Year, k = 5), data = Grouped, family = tw, method = "REML")
plot(gamTw, pages = 1)
summary(gamTw)
viz = getViz(gamTw)
print(plot(viz,allTerms=T),pages=1)
fig6 =paste("G:/.shortcut-targets-by-id/1lwxYjZ-5ScY65o65OfWCtYU-FpMLIpXS/Arctic_Sperm whales/figures/GAM_Grouped_HARPyears.png",sep="")
ggsave(fig6)
GroupedHARP = aggregate(DayIceHARP,list(rep(1:(nrow(DayIceHARP)%/%n+1),each=n,len=nrow(DayIceHARP))),mean)[-1];
gamTw = gam(DutyBin ~ s(day, bs = 'cc', k = 15)+s(Ice)+s(Year, k = 5), data = GroupedHARP, family = tw, method = "REML")
plot(gamTw, pages = 1)
summary(gamTw)
viz = getViz(gamTw)
print(plot(viz,allTerms=T),pages=1)
fig6 =paste("G:/.shortcut-targets-by-id/1lwxYjZ-5ScY65o65OfWCtYU-FpMLIpXS/Arctic_Sperm whales/figures/GAM_Grouped_HARPyears.png",sep="")
ggsave(fig6)
gamTw = gam(DutyBin ~ s(day, bs = 'cc', k = 15)+s(Ice)+s(Year, k = 5), data = Grouped, family = tw, method = "REML")
plot(gamTw, pages = 1)
summary(gamTw)
viz = getViz(gamTw)
print(plot(viz,allTerms=T),pages=1)
fig6 =paste("G:/.shortcut-targets-by-id/1lwxYjZ-5ScY65o65OfWCtYU-FpMLIpXS/Arctic_Sperm whales/figures/GAM_Grouped_Allyears.png",sep="")
ggsave(fig6)
gamTw = gam(DutyBin ~ s(day, bs = 'cc', k = 15)+s(Ice)+s(Year, k = 5), data = GroupedHARP, family = tw, method = "REML")
plot(gamTw, pages = 1)
summary(gamTw)
viz = getViz(gamTw)
print(plot(viz,allTerms=T),pages=1)
fig6 =paste("G:/.shortcut-targets-by-id/1lwxYjZ-5ScY65o65OfWCtYU-FpMLIpXS/Arctic_Sperm whales/figures/GAM_Grouped_HARPyears.png",sep="")
ggsave(fig6)
